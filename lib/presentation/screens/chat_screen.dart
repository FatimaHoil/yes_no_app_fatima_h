import 'package:flutter/material.dart';
import 'package:provider/provider.dart';
import 'package:yes_no_app_fatima_h/domain/entities/message.dart';
import 'package:yes_no_app_fatima_h/presentation/providers/chat_provider.dart';
import 'package:yes_no_app_fatima_h/presentation/widgets/chat/him_message.dart';
import 'package:yes_no_app_fatima_h/presentation/widgets/chat/my_message.dart';
import 'package:yes_no_app_fatima_h/presentation/widgets/share/message_box.dart';


class ChatScreen extends StatelessWidget {
  const ChatScreen({super.key});

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: const Text('Seo jun'),
        leading: const Padding(
          padding: EdgeInsets.all(1.0),
          child: CircleAvatar(
            backgroundImage: NetworkImage('data:image/jpeg;base64,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'),
          ),
        ),
      ),
      body: _chatview(),
    );
  }
}

class _chatview extends StatelessWidget {

  @override
  Widget build(BuildContext context) {
    

   final chatprovider = context.watch<ChatProvider>();
   
    return SafeArea(
      child: Padding(
        padding: const EdgeInsets.symmetric(horizontal: 10),
        child: Column(
          children: [
            Expanded(
              child:ListView.builder(
              controller: chatprovider.chatScrollcontroler,
              itemCount: chatprovider.message.length,
              itemBuilder: (context, index) {
                final message = chatprovider.message[index];
              
                return (message.fromWho == FromWho.him)
                  ? SeojunMessage(message: message)
                  : MyMessage(message: message,); 
            },)),
        
             MessageBox(
              onValue: (value) => chatprovider.sendMessage(value),
             )
          ],
        ),
      ),
    );
  }
}